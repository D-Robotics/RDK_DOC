"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[1217],{85281:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>u,toc:()=>d});var s=t(74848),l=t(28453),o=t(93859),a=t(19365);const r={sidebar_position:1},i="5.4.1 SLAM",u={id:"Robot_development/apps/slam",title:"5.4.1 SLAM",description:"Introduction",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/05_Robot_development/04_apps/slam.md",sourceDirName:"05_Robot_development/04_apps",slug:"/Robot_development/apps/slam",permalink:"/rdk_doc/en/Robot_development/apps/slam",draft:!1,unlisted:!1,editUrl:"https://github.com/D-Robotics/rdk_doc/blob/main/docs/docs/05_Robot_development/04_apps/slam.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Visual SLAM",permalink:"/rdk_doc/en/Robot_development/boxs/function/orb_slam3"},next:{title:"5.4.2 Navigation2",permalink:"/rdk_doc/en/Robot_development/apps/navigation2"}},c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Supported Platforms",id:"supported-platforms",level:2},{value:"Preparation",id:"preparation",level:2},{value:"RDK",id:"rdk",level:3},{value:"Usage",id:"usage",level:2},{value:"RDK",id:"rdk-1",level:3},{value:"Result Analysis",id:"result-analysis",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"541-slam",children:"5.4.1 SLAM"}),"\n","\n",(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsx)(n.p,{children:"SLAM (Simultaneous Localization and Mapping) is a technique used to simultaneously estimate the location of a robot and create a map of its environment. In this chapter, we will use ROS2 SLAM-Toolbox to perform mapping on a simulated car in Gazebo, and observe the mapping results through Rviz2. The SLAM-Toolbox runs on the RDK, while Gazebo and Rviz2 run on a PC in the same network as the RDK."}),"\n",(0,s.jsx)(n.h2,{id:"supported-platforms",children:"Supported Platforms"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Platform"}),(0,s.jsx)(n.th,{children:"System"}),(0,s.jsx)(n.th,{children:"Function"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"RDK X3, RDK X3 Module, RDK X5"}),(0,s.jsx)(n.td,{children:"Ubuntu 20.04 (Foxy), Ubuntu 22.04 (Humble)"}),(0,s.jsx)(n.td,{children:"Start the simulation environment on the PC and perform SLAM mapping on the RDK, finally display the mapping results using Rviz2."})]})})]}),"\n",(0,s.jsx)(n.h2,{id:"preparation",children:"Preparation"}),"\n",(0,s.jsx)(n.h3,{id:"rdk",children:"RDK"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"The RDK has been flashed with the  Ubuntu 20.04/22.04 image provided by D-Robotics."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"TogetheROS.Bot has been successfully installed on the RDK."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"After the successful installation of tros.b, install the SLAM-Toolbox:"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.A,{groupId:"tros-distro",children:[(0,s.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo apt-get install ros-foxy-slam-toolbox\n"})})}),(0,s.jsx)(a.A,{value:"humble",label:"Humble",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo apt-get install ros-humble-slam-toolbox\n"})})})]}),"\n",(0,s.jsxs)(n.admonition,{type:"caution",children:[(0,s.jsx)(n.p,{children:"If the installation fails and the error is as follows:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"  The following packages have unmet dependencies:\n   ros-foxy-slam-toolbox : Depends: ros-foxy-nav2-map-server but it is not going to be installed\n  E: Unable to correct problems, you have held broken packages.\n"})}),(0,s.jsx)(n.p,{children:"Please execute the following command before installing:"}),(0,s.jsx)(n.p,{children:"apt update"}),(0,s.jsx)(n.p,{children:"sudo apt install libwebp6=0.6.1-2ubuntu0.20.04.3"})]}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsx)(n.li,{children:"The PC, which is in the same network as the RDK, has been installed with Ubuntu 20.04, ROS2 Foxy Desktop version, Gazebo simulation environment, and the data visualization tool Rviz2."}),"\n"]}),"\n",(0,s.jsxs)(o.A,{groupId:"tros-distro",children:[(0,s.jsxs)(a.A,{value:"foxy",label:"Foxy",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Ubuntu 20.04 system and ",(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/foxy/Installation/Ubuntu-Install-Debians.html",children:"ROS2 Foxy Desktop Full"})]}),"\n",(0,s.jsx)(n.li,{children:"Gazebo and Turtlebot3 related packages. Installation commands:"}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:" sudo apt-get install ros-foxy-gazebo-*\n sudo apt install ros-foxy-turtlebot3\n sudo apt install ros-foxy-turtlebot3-bringup\n sudo apt install ros-foxy-turtlebot3-simulations\n sudo apt install ros-foxy-teleop-twist-keyboard\n"})})]}),(0,s.jsxs)(a.A,{value:"humble",label:"Humble",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Ubuntu 22.04 system and ",(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Installation/Ubuntu-Install-Debians.html",children:"ROS2 Humble Desktop Full"})]}),"\n",(0,s.jsx)(n.li,{children:"Gazebo and Turtlebot3 related packages. Installation commands:"}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"sudo apt-get install ros-humble-gazebo-*\nsudo apt install ros-humble-turtlebot3\nsudo apt install ros-humble-turtlebot3-bringup\nsudo apt install ros-humble-turtlebot3-simulations\nsudo apt install ros-humble-teleop-twist-keyboard\n"})})]})]}),"\n",(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.h3,{id:"rdk-1",children:"RDK"}),"\n",(0,s.jsx)(n.p,{children:"This section introduces how to use RDK to run SLAM and observe mapping effect using PC."}),"\n",(0,s.jsx)(n.p,{children:"Start the simulation environment on the PC:"}),"\n",(0,s.jsxs)(o.A,{groupId:"tros-distro",children:[(0,s.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"source /opt/ros/foxy/setup.bash\n"})})}),(0,s.jsx)(a.A,{value:"humble",label:"Humble",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"source /opt/ros/humble/setup.bash\n"})})})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"export TURTLEBOT3_MODEL=burger\nros2 launch turtlebot3_gazebo turtlebot3_world.launch.py\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The simulation environment is shown in the figure below:\n",(0,s.jsx)(n.img,{src:t(98302).A+"",width:"1436",height:"896"})]}),"\n",(0,s.jsx)(n.p,{children:"Open another console on the PC and start Rviz2 to observe the mapping effect:"}),"\n",(0,s.jsxs)(o.A,{groupId:"tros-distro",children:[(0,s.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"source /opt/ros/foxy/setup.bash\n"})})}),(0,s.jsx)(a.A,{value:"humble",label:"Humble",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"source /opt/ros/humble/setup.bash\n"})})})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 launch turtlebot3_bringup rviz2.launch.py\n"})}),"\n",(0,s.jsxs)(n.p,{children:['After opening Rviz2, the "map" visualization option needs to be added to display the built map. The steps are as follows:\n',(0,s.jsx)(n.img,{src:t(6117).A+"",width:"976",height:"881"})]}),"\n",(0,s.jsx)(n.p,{children:"Run SLAM-Toolbox on the RDK:"}),"\n",(0,s.jsxs)(o.A,{groupId:"tros-distro",children:[(0,s.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/setup.bash\n"})})}),(0,s.jsx)(a.A,{value:"humble",label:"Humble",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 launch slam_toolbox online_sync_launch.py\n"})}),"\n",(0,s.jsx)(n.p,{children:"Open another console on the PC and start the control tool to control the movement of the robot car with the keyboard. The control method can be found in the log printed on the console:"}),"\n",(0,s.jsxs)(o.A,{groupId:"tros-distro",children:[(0,s.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"source /opt/ros/foxy/setup.bash\n"})})}),(0,s.jsx)(a.A,{value:"humble",label:"Humble",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"source /opt/ros/humble/setup.bash\n"})})})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 run teleop_twist_keyboard teleop_twist_keyboard\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Control the robot car to move. As the robot car detects more environmental information with the radar, the SLAM algorithm also builds the environmental map, which can be observed in Rviz2.\n",(0,s.jsx)(n.img,{src:t(54748).A+"",width:"1632",height:"900"})]}),"\n",(0,s.jsx)(n.h2,{id:"result-analysis",children:"Result Analysis"}),"\n",(0,s.jsx)(n.p,{children:"The terminal output of running on the RDK board is as follows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"[INFO] [launch]: All log files can be found below /root/.ros/log/2022-06-10-06-40-34-204213-ubuntu-5390\n[INFO] [launch]: Default logging verbosity is set to INFO\n```[INFO] [sync_slam_toolbox_node-1]: process started with pid [5392]\n[sync_slam_toolbox_node-1] [INFO] [1654843239.403931058] [slam_toolbox]: Node using stack size 40000000\n[sync_slam_toolbox_node-1] [INFO] [1654843240.092340814] [slam_toolbox]: Using solver plugin solver_plugins::CeresSolver\n[sync_slam_toolbox_node-1] [INFO] [1654843240.096554433] [slam_toolbox]: CeresSolver: Using SCHUR_JACOBI preconditioner.\n[sync_slam_toolbox_node-1] Info: clipped range threshold to be within minimum and maximum range!\n[sync_slam_toolbox_node-1] [WARN] [1654843589.431524393] [slam_toolbox]: maximum laser range setting (20.0 m) exceeds the capabilities of the used Lidar (3.5 m)\n[sync_slam_toolbox_node-1] Registering sensor: [Custom Described Lidar]\n"})})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},19365:(e,n,t)=>{t.d(n,{A:()=>a});t(96540);var s=t(34164);const l={tabItem:"tabItem_Ymn6"};var o=t(74848);function a(e){let{children:n,hidden:t,className:a}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,s.A)(l.tabItem,a),hidden:t,children:n})}},93859:(e,n,t)=>{t.d(n,{A:()=>_});var s=t(96540),l=t(34164),o=t(86641),a=t(56347),r=t(205),i=t(38874),u=t(24035),c=t(82993);function d(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,s.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:t,attributes:s,default:l}}=e;return{value:n,label:t,attributes:s,default:l}}))}(t);return function(e){const n=(0,u.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function b(e){let{queryString:n=!1,groupId:t}=e;const l=(0,a.W6)(),o=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,i.aZ)(o),(0,s.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(l.location.search);n.set(o,e),l.replace({...l.location,search:n.toString()})}),[o,l])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:l}=e,o=h(e),[a,i]=(0,s.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const s=t.find((e=>e.default))??t[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:o}))),[u,d]=b({queryString:t,groupId:l}),[m,x]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[l,o]=(0,c.Dv)(t);return[l,(0,s.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:l}),g=(()=>{const e=u??m;return p({value:e,tabValues:o})?e:null})();(0,r.A)((()=>{g&&i(g)}),[g]);return{selectedValue:a,selectValue:(0,s.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);i(e),d(e),x(e)}),[d,x,o]),tabValues:o}}var x=t(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=t(74848);function j(e){let{className:n,block:t,selectedValue:s,selectValue:a,tabValues:r}=e;const i=[],{blockElementScrollPositionUntilNextRender:u}=(0,o.a_)(),c=e=>{const n=e.currentTarget,t=i.indexOf(n),l=r[t].value;l!==s&&(u(n),a(l))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=i.indexOf(e.currentTarget)+1;n=i[t]??i[0];break}case"ArrowLeft":{const t=i.indexOf(e.currentTarget)-1;n=i[t]??i[i.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.A)("tabs",{"tabs--block":t},n),children:r.map((e=>{let{value:n,label:t,attributes:o}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>i.push(e),onKeyDown:d,onClick:c,...o,className:(0,l.A)("tabs__item",g.tabItem,o?.className,{"tabs__item--active":s===n}),children:t??n},n)}))})}function v(e){let{lazy:n,children:t,selectedValue:l}=e;const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=o.find((e=>e.props.value===l));return e?(0,s.cloneElement)(e,{className:"margin-top--md"}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==l})))})}function y(e){const n=m(e);return(0,f.jsxs)("div",{className:(0,l.A)("tabs-container",g.tabList),children:[(0,f.jsx)(j,{...n,...e}),(0,f.jsx)(v,{...n,...e})]})}function _(e){const n=(0,x.A)();return(0,f.jsx)(y,{...e,children:d(e.children)},String(n))}},98302:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/gazebo-916bb92628dd6e28c62b5e124c58c05c.jpg"},54748:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/map-c046adcf8e755c070c56cb5442b1fe04.jpg"},6117:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/rvizsetting-5739327dc8ab96d59f5d82793670045c.jpg"},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var s=t(96540);const l={},o=s.createContext(l);function a(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);