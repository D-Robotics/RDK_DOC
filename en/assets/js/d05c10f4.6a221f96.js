"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[114],{41329:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>u});var n=s(74848),a=s(28453),r=s(93859),i=s(19365);const o={sidebar_position:2},l="YOLOv8-Seg",c={id:"Robot_development/boxs/segmentation/yolov8_seg",title:"YOLOv8-Seg",description:"Introduction",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/05_Robot_development/03_boxs/segmentation/yolov8_seg.md",sourceDirName:"05_Robot_development/03_boxs/segmentation",slug:"/Robot_development/boxs/segmentation/yolov8_seg",permalink:"/rdk_doc/en/Robot_development/boxs/segmentation/yolov8_seg",draft:!1,unlisted:!1,editUrl:"https://d-robotics.github.io/rdk_doc/RDK/docs/05_Robot_development/03_boxs/segmentation/yolov8_seg.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"mobilenet_unet",permalink:"/rdk_doc/en/Robot_development/boxs/segmentation/mobilenet_unet"},next:{title:"Human Detection and Tracking",permalink:"/rdk_doc/en/Robot_development/boxs/function/mono2d_body_detection"}},d={},u=[{value:"Introduction",id:"introduction",level:2},{value:"Supported Platforms",id:"supported-platforms",level:2},{value:"Preparation",id:"preparation",level:2},{value:"RDK",id:"rdk",level:3},{value:"Use the Camera to Publish Images",id:"use-the-camera-to-publish-images",level:4},{value:"Use a MIPI Camera to Publish Images",id:"use-a-mipi-camera-to-publish-images",level:5},{value:"Use a USB Camera to Publish Images",id:"use-a-usb-camera-to-publish-images",level:5},{value:"Use local images offline",id:"use-local-images-offline",level:4},{value:"Analysis of Results",id:"analysis-of-results",level:2},{value:"Use a Camera to Publishing Images",id:"use-a-camera-to-publishing-images",level:3},{value:"Use Local Images Offline",id:"use-local-images-offline-1",level:3}];function m(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"yolov8-seg",children:"YOLOv8-Seg"}),"\n","\n",(0,n.jsx)(t.h2,{id:"introduction",children:"Introduction"}),"\n",(0,n.jsx)(t.p,{children:"The YOLOv8-Seg algorithm example uses images as input and performs algorithm inference using BPU. It publishes segmentation result messages."}),"\n",(0,n.jsxs)(t.p,{children:["The YOLOv8-Seg is trained on the ",(0,n.jsx)(t.a,{href:"http://cocodataset.org/",children:"COCO128-seg"})," dataset and the Onnx model. It supports instance segmentation for 80 categories including humans, animals, fruits, and vehicles."]}),"\n",(0,n.jsxs)(t.p,{children:["Code repository: (",(0,n.jsx)(t.a,{href:"https://github.com/D-Robotics/hobot_dnn",children:"https://github.com/D-Robotics/hobot_dnn"}),")"]}),"\n",(0,n.jsx)(t.p,{children:"Applications: YOLOv8-Seg is capable of recognizing objects and performing precise segmentation. It can be applied in the fields of autonomous driving, geological detection, and medical image analysis."}),"\n",(0,n.jsx)(t.h2,{id:"supported-platforms",children:"Supported Platforms"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Platform"}),(0,n.jsx)(t.th,{children:"System"}),(0,n.jsx)(t.th,{children:"Function"})]})}),(0,n.jsx)(t.tbody,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"RDK X5"}),(0,n.jsx)(t.td,{children:"Ubuntu 22.04 (Humble)"}),(0,n.jsx)(t.td,{children:"- Start MIPI/USB cameras or local image and save the rendered results offline."})]})})]}),"\n",(0,n.jsx)(t.h2,{id:"preparation",children:"Preparation"}),"\n",(0,n.jsx)(t.h3,{id:"rdk",children:"RDK"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"The RDK platform has been flashed with the provided 22.04 system image."}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"TogetheROS.Bot has been successfully installed on the RDK platform."}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"A MIPI or USB camera has been installed on the RDK platform. If there is no camera available, the algorithm's effects can be experienced by using local JPEG/PNG images offline."}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.h4,{id:"use-the-camera-to-publish-images",children:"Use the Camera to Publish Images"}),"\n",(0,n.jsx)(t.h5,{id:"use-a-mipi-camera-to-publish-images",children:"Use a MIPI Camera to Publish Images"}),"\n",(0,n.jsxs)(t.p,{children:['The YOLOv8-Seg example subscribes to images published by the sensor package. IF set "dnn_example_dump_render_img:=1", it will save the rendered images automatically in the running directory. The saved images are named in the format of ',(0,n.jsx)(t.code,{children:"render_frameid_timestampInSeconds_timestampInNanoseconds.jpg"}),"."]}),"\n",(0,n.jsx)(r.A,{groupId:"tros-distro",children:(0,n.jsx)(i.A,{value:"humble",label:"Humble",children:(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:"# Configuring MIPI camera\nexport CAM_TYPE=mipi\n\n# Start the launch file\nros2 launch dnn_node_example dnn_node_example.launch.py dnn_example_dump_render_img:=0 dnn_example_config_file:=config/yolov8segworkconfig.json dnn_example_image_width:=1920 dnn_example_image_height:=1080\n"})}),"\n",(0,n.jsx)(t.h5,{id:"use-a-usb-camera-to-publish-images",children:"Use a USB Camera to Publish Images"}),"\n",(0,n.jsx)(r.A,{groupId:"tros-distro",children:(0,n.jsx)(i.A,{value:"humble",label:"Humble",children:(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:"# Configuring USB camera\nexport CAM_TYPE=usb\n\n# Start the launch file\nros2 launch dnn_node_example dnn_node_example.launch.py dnn_example_dump_render_img:=0 dnn_example_config_file:=config/yolov8segworkconfig.json dnn_example_image_width:=1920 dnn_example_image_height:=1080\n"})}),"\n",(0,n.jsx)(t.h4,{id:"use-local-images-offline",children:"Use local images offline"}),"\n",(0,n.jsx)(t.p,{children:"The YOLOv8-Seg example uses local JPEG/PNG format images for feedback. After inference, the rendered images of the algorithm results are stored in the local running path."}),"\n",(0,n.jsx)(r.A,{groupId:"tros-distro",children:(0,n.jsx)(i.A,{value:"humble",label:"Humble",children:(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:"# Start the launch file\nros2 launch dnn_node_example dnn_node_example_feedback.launch.py dnn_example_config_file:=config/yolov8segworkconfig.json dnn_example_image:=config/test.jpeg\n"})}),"\n",(0,n.jsx)(t.h2,{id:"analysis-of-results",children:"Analysis of Results"}),"\n",(0,n.jsx)(t.h3,{id:"use-a-camera-to-publishing-images",children:"Use a Camera to Publishing Images"}),"\n",(0,n.jsx)(t.p,{children:"The output shows the following information:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:"[example-3] [WARN] [0000001244.489045384] [example]: Sub img fps: -1.00, Smart fps: 6.00, infer time ms: 12, post process time ms: 31\n[example-3] [WARN] [0000001245.524813052] [example]: Sub img fps: 5.84, Smart fps: 4.99, infer time ms: 8, post process time ms: 64\n[example-3] [WARN] [0000001246.526635344] [example]: Sub img fps: 4.96, Smart fps: 5.00, infer time ms: 8, post process time ms: 66\n[example-3] [WARN] [0000001247.528846136] [example]: Sub img fps: 5.00, Smart fps: 5.00, infer time ms: 8, post process time ms: 68\n[example-3] [WARN] [0000001248.528474095] [example]: Sub img fps: 5.00, Smart fps: 5.00, infer time ms: 8, post process time ms: 68\n[example-3] [WARN] [0000001249.528576345] [example]: Sub img fps: 5.00, Smart fps: 5.00, infer time ms: 8, post process time ms: 68\n[example-3] [WARN] [0000001250.493265846] [example]: Sub img fps: 5.02, Smart fps: 5.00, infer time ms: 8, post process time ms: 32\n[example-3] [WARN] [0000001251.528909346] [example]: Sub img fps: 4.98, Smart fps: 5.00, infer time ms: 8, post process time ms: 67\n"})}),"\n",(0,n.jsxs)(t.p,{children:["The log output shows that the topic used for publishing the algorithm inference results is ",(0,n.jsx)(t.code,{children:"hobot_dnn_detection"}),", and the topic used for subscribing to the images is ",(0,n.jsx)(t.code,{children:"/hbmem_img"}),". The frame rate at which the images are published will adapt according to the algorithm inference output frame rate. Additionally, rendering the semantic segmentation results on the RDK and saving the images in the running path will cause a decrease in frame rate."]}),"\n",(0,n.jsxs)(t.p,{children:["Original image:\n",(0,n.jsx)(t.img,{alt:"raw",src:s(56536).A+"",width:"5977",height:"3355"})]}),"\n",(0,n.jsxs)(t.p,{children:["Rendered image:\n",(0,n.jsx)(t.img,{alt:"render_web",src:s(51509).A+"",width:"3840",height:"1919"})]}),"\n",(0,n.jsx)(t.h3,{id:"use-local-images-offline-1",children:"Use Local Images Offline"}),"\n",(0,n.jsx)(t.p,{children:"The output shows the following information:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:"[INFO] [0000001744.811779665] [example]: Dnn node feed with local image: /userdata/config/test.jpg\n[INFO] [0000001746.237111249] [example]: Output from frame_id: feedback, stamp: 0.0\n[INFO] [0000001746.266157040] [PostProcessBase]: out box size: 6\n[INFO] [0000001746.266340040] [PostProcessBase]: det rect: 90.4946 58.2675 192.103 351.403, det type: person, score:0.927177\n[INFO] [0000001746.267129832] [PostProcessBase]: det rect: 455.518 77.1254 536.289 354.541, det type: person, score:0.909735\n[INFO] [0000001746.267248457] [PostProcessBase]: det rect: 381.604 103.953 464.446 327.9, det type: person, score:0.898899\n[INFO] [0000001746.267331624] [PostProcessBase]: det rect: 204.864 71.6262 303.593 351.835, det type: person, score:0.887814\n[INFO] [0000001746.267404540] [PostProcessBase]: det rect: 317.885 108.287 389.773 338.197, det type: person, score:0.866887\n[INFO] [0000001746.267486457] [PostProcessBase]: det rect: 181.487 111.093 202.097 132.665, det type: car, score:0.443035\n[INFO] [0000001746.267548999] [ClassificationPostProcess]: out cls size: 0\n[INFO] [0000001746.267662832] [SegmentationPostProcess]: features size: 14240, width: 160, height: 89, num_classes: 80, step: 1\n[INFO] [0000001746.270546040] [ImageUtils]: target size: 7\n[INFO] [0000001746.270674082] [ImageUtils]: target type: person, rois.size: 1\n[INFO] [0000001746.270745915] [ImageUtils]: roi.type: person, x_offset: 90 y_offset: 58 width: 101 height: 293\n[INFO] [0000001746.271122207] [ImageUtils]: target type: person, rois.size: 1\n[INFO] [0000001746.271162499] [ImageUtils]: roi.type: person, x_offset: 455 y_offset: 77 width: 80 height: 277\n[INFO] [0000001746.271325499] [ImageUtils]: target type: person, rois.size: 1\n[INFO] [0000001746.271362082] [ImageUtils]: roi.type: person, x_offset: 381 y_offset: 103 width: 82 height: 223\n[INFO] [0000001746.271491040] [ImageUtils]: target type: person, rois.size: 1\n[INFO] [0000001746.271525249] [ImageUtils]: roi.type: person, x_offset: 204 y_offset: 71 width: 98 height: 280\n[INFO] [0000001746.271782749] [ImageUtils]: target type: person, rois.size: 1\n[INFO] [0000001746.271819457] [ImageUtils]: roi.type: person, x_offset: 317 y_offset: 108 width: 71 height: 229\n[INFO] [0000001746.271947790] [ImageUtils]: target type: car, rois.size: 1\n[INFO] [0000001746.271982374] [ImageUtils]: roi.type: car, x_offset: 181 y_offset: 111 width: 20 height: 21\n[INFO] [0000001746.272044124] [ImageUtils]: target type: parking_space, rois.size: 0\n[WARN] [0000001746.276824624] [ImageUtils]: Draw result to file: render_feedback_0_0.jpeg\n"})}),"\n",(0,n.jsxs)(t.p,{children:["The log shows that the algorithm performs inference using the input image ",(0,n.jsx)(t.code,{children:"config/raw_unet.jpeg"}),", and the rendered image is stored with the file ",(0,n.jsx)(t.code,{children:"render_unet_feedback_0_0.jpeg"}),". The rendered image looks like this:"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"render_feedback",src:s(9676).A+"",width:"640",height:"359"})})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(m,{...e})}):m(e)}},19365:(e,t,s)=>{s.d(t,{A:()=>i});s(96540);var n=s(34164);const a={tabItem:"tabItem_Ymn6"};var r=s(74848);function i(e){let{children:t,hidden:s,className:i}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,n.A)(a.tabItem,i),hidden:s,children:t})}},93859:(e,t,s)=>{s.d(t,{A:()=>I});var n=s(96540),a=s(34164),r=s(86641),i=s(56347),o=s(205),l=s(38874),c=s(24035),d=s(82993);function u(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function m(e){const{values:t,children:s}=e;return(0,n.useMemo)((()=>{const e=t??function(e){return u(e).map((e=>{let{props:{value:t,label:s,attributes:n,default:a}}=e;return{value:t,label:s,attributes:n,default:a}}))}(s);return function(e){const t=(0,c.X)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,s])}function h(e){let{value:t,tabValues:s}=e;return s.some((e=>e.value===t))}function p(e){let{queryString:t=!1,groupId:s}=e;const a=(0,i.W6)(),r=function(e){let{queryString:t=!1,groupId:s}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!s)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return s??null}({queryString:t,groupId:s});return[(0,l.aZ)(r),(0,n.useCallback)((e=>{if(!r)return;const t=new URLSearchParams(a.location.search);t.set(r,e),a.replace({...a.location,search:t.toString()})}),[r,a])]}function g(e){const{defaultValue:t,queryString:s=!1,groupId:a}=e,r=m(e),[i,l]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:s}=e;if(0===s.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:s}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${s.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=s.find((e=>e.default))??s[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:r}))),[c,u]=p({queryString:s,groupId:a}),[g,f]=function(e){let{groupId:t}=e;const s=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,r]=(0,d.Dv)(s);return[a,(0,n.useCallback)((e=>{s&&r.set(e)}),[s,r])]}({groupId:a}),b=(()=>{const e=c??g;return h({value:e,tabValues:r})?e:null})();(0,o.A)((()=>{b&&l(b)}),[b]);return{selectedValue:i,selectValue:(0,n.useCallback)((e=>{if(!h({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),f(e)}),[u,f,r]),tabValues:r}}var f=s(92303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=s(74848);function _(e){let{className:t,block:s,selectedValue:n,selectValue:i,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),d=e=>{const t=e.currentTarget,s=l.indexOf(t),a=o[s].value;a!==n&&(c(t),i(a))},u=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const s=l.indexOf(e.currentTarget)+1;t=l[s]??l[0];break}case"ArrowLeft":{const s=l.indexOf(e.currentTarget)-1;t=l[s]??l[l.length-1];break}}t?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":s},t),children:o.map((e=>{let{value:t,label:s,attributes:r}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:n===t?0:-1,"aria-selected":n===t,ref:e=>l.push(e),onKeyDown:u,onClick:d,...r,className:(0,a.A)("tabs__item",b.tabItem,r?.className,{"tabs__item--active":n===t}),children:s??t},t)}))})}function v(e){let{lazy:t,children:s,selectedValue:a}=e;const r=(Array.isArray(s)?s:[s]).filter(Boolean);if(t){const e=r.find((e=>e.props.value===a));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:r.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==a})))})}function j(e){const t=g(e);return(0,x.jsxs)("div",{className:(0,a.A)("tabs-container",b.tabList),children:[(0,x.jsx)(_,{...t,...e}),(0,x.jsx)(v,{...t,...e})]})}function I(e){const t=(0,f.A)();return(0,x.jsx)(j,{...e,children:u(e.children)},String(t))}},9676:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/local-8ea9d895f2e02f6176ec7fa260301508.jpeg"},56536:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/test-90cb212a8217603c8c4870208e9e79d3.jpg"},51509:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/web-bec7eb50ef1dacab9082c9349f6fc2d2.jpeg"},28453:(e,t,s)=>{s.d(t,{R:()=>i,x:()=>o});var n=s(96540);const a={},r=n.createContext(a);function i(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);